# HighLow
High Low Cipher

# HighLowCipher

HighLowCipher is a symmetric encryption system that combines dynamic S-Box transformations, lattice-based HMAC authentication, and a secure counter mechanism. It is designed to ensure robust data integrity, confidentiality, and authenticity.

---

## Features

1. **Dynamic S-Box Transformations**
   - High and low states for secure nibble-based encryption.
   - Bijective S-Box ensures one-to-one and onto mappings.

2. **Lattice-Based HMAC**
   - Ensures integrity with robust cryptographic authentication.
   - Verifies ciphertext integrity using SHA3-256 and lattice encryption.

3. **Counter-Based Uniqueness**
   - Appends a secure counter to ensure unique ciphertexts, even for identical plaintext inputs.

4. **Prime Verification**
   - Dynamically generates secure prime numbers for modulus values.

---

## Mathematical Proofs

### 1. **Bijective S-Box Construction**
The S-Box is bijective, ensuring:
- **Injectivity**: Each input maps to a unique output.
- **Surjectivity**: Every possible output is mapped by an input.

\[
\forall x, y \in S, x \neq y \implies S(x) \neq S(y)
\]
\[
\forall y \in \{0, 1, ..., n-1\}, \exists x \in \{0, 1, ..., n-1\}, S(x) = y
\]

The S-Box is verified for uniqueness using a `HashSet`.

---

### 2. **Cipher State Transformation**
#### Encryption:
For a nibble \(n\) and secret value \(s\), the transformed nibble is:
\[
T(n) = S((n + s) \mod m)
\]
where \(m\) is the modulus (e.g., 16).

#### Decryption:
The reverse transformation ensures recoverability:
\[
T^{-1}(n) = S^{-1}((n - s) \mod m)
\]

The bijectivity of the S-Box guarantees that \(S^{-1}\) exists, making decryption reliable.

---

### 3. **Counter-Based Uniqueness**
To prevent repeated states, a counter \(C\) is appended to the plaintext:
\[
\text{State} = \text{Plaintext} \| C
\]

#### Proof:
- Each encryption increments the counter:
\[
C_{i+1} = C_i + 1
\]
- Unique counters ensure that even identical plaintexts produce different ciphertexts.

---

### 4. **Lattice-Based HMAC Integrity**
The lattice-based HMAC authenticates the ciphertext using the following process:

#### Signature Generation:
1. Hash the ciphertext with SHA3-256:
\[
\text{Hash} = \text{SHA3-256}(\text{Ciphertext})
\]
2. Encrypt the hash with the lattice public key, adding Gaussian noise:
\[
v_i = b_r + \eta + b \cdot (m / 2) \mod m
\]

#### Verification:
- Decrypt the HMAC and compare the bits with the original hash:
\[
\text{Hash Match} \implies \text{Integrity Verified}
\]

---

### 5. **Prime Verification for Security**
Dynamic primes ensure secure modulus values. A candidate \(p\) is tested with:
\[
\forall d \in \{2, 3, ..., \sqrt{p}\}, \; p \mod d \neq 0 \implies p \text{ is prime.}
\]

The `generate_secure_prime` function repeats the test until a valid prime is found.

---

## How It Works

1. **Encryption:**
   - Converts plaintext to nibbles.
   - Applies high and low S-Box transformations.
   - Appends a counter for uniqueness.
   - Computes HMAC for ciphertext integrity.

2. **Decryption:**
   - Verifies HMAC integrity.
   - Reverses S-Box transformations.
   - Removes the counter to retrieve plaintext.

---

## Usage

```
Enter plaintext to encrypt: Hello PQC World!
User Input Plaintext: "Hello PQC World!"
Generated Passphrase: "bkeohehijkjexygw"
Generated Shared Secret: [239, 208, 7, 115, 188, 33, 167, 222, 107, 175, 133, 197, 228, 90, 199, 46]
Modulus: 16
S-Box Size: 16
Dimension Parameter (dim_n): 512
Enter noise standard deviation (e.g., 0.1): 0.1
Ciphertext (Hex): 58e59cfcbf5080512360c77f72dc94d121d0105080601000
HMAC (Hex): (Hash: e459000027400000a96d0000e53b000001420000aa130000b2160000fd210000467a0000e10e0000bc0f000041480000e1010000391d0000ca6100003a070000127c000013460000e155000091500000c5680000fe51000077370000251d0000584a0000ec0c00009d1d0000087700006b740000105a0000207400008853000024780000592b00003871000054760000883900007f710000a9040000412e0000122400003a3e00000c4700008e290000ad51000037660000407800001e230000503e0000007d00008d110000ac4d0000a26d0000b32800000270000025020000004900000177000002230000562f00008f7700007618000098110000276b00003a3e000082580000da5400001e610000a45400002e620000980400004c1100008a5100002e4b000060530000603f00009b570000bd47000075560000b4790000fd440000702b0000c6200000565f0000b83a0000cb140000e27d0000e6030000c91e0000e07600001267000079710000c81b0000ec3d00006d430000e10f0000e70c000027200000e71e00000e5a0000d8200000d22f00001d580000fa270000e14d00000f4f0000861c0000fa7100006a6700006d100000c45a0000c86f0000d3300000650600006b1e0000a1680000cf4d0000340a0000326f000097160000436400004c1a0000851e00008c3500001d0e0000e63400008c0d00004c7b00009d3300004a1f000007450000ee130000d83c0000172a00004e1000005c0e00006415000099290000bf6c00006b7c0000e1560000ea490000595c000049020000b1120000a10c0000ee1c0000c23b000025500000eb5d0000a85700007f580000dc2f00002f1d00006c290000057e0000db300000b7350000f43000003c3c0000605f0000017100002b58000077000000dc520000de080000c27d0000d5260000171900006a060000e66f000048460000cf2100000f2900008b420000216500009368000078740000622400005b59000067370000225500008a200000e4580000ff3200007f2d0000e95b00004e4f0000d6230000e71f0000b40a0000e5790000f6220000ed3000006f700000e0150000686300009e370000477c0000ee620000512d00000c1e0000d12400006a700000e54b0000c9470000e1310000f3690000324c0000197600006f670000b976000097740000795e0000683d00006c6b0000f55b00001927000019360000f7670000d8650000dd250000f9270000540a0000985d0000a541000043730000b9630000ad310000c73d0000f5320000940d0000914000003403000079390000ff760000f84d000070020000d6310000654400001946000021360000ad48000002290000f50400006d370000be04000057470000e326000007530000c54a000081710000e53600004b4600004819000047100000ab340000205800000d3e00007b1a000023210000a11f0000e25a00009d2f00009a4d0000941e00000a030000df220000113a000076500000d46600005e470000ac3e00004d3900001e230000e2350000cc3e000007230000bc7700009a7000000d600000366600005744000042640000570c000058620000497d0000d36e0000d90000003f1b0000786300000c090000ee1a0000b07400008f640000dc360000d3020000b23b0000e12e00001e31000042660000793a00005b4a000050720000637a0000962400007a0800006c440000e17e0000337d0000937900009c260000816700003b010000406b0000b24b00003c500000e72100001b600000ea680000f7080000e31d00004d210000ab1000003f6000006a1d0000c80700008a3e000051730000e83900004c0000002b2e0000957d0000597100009a1b000086360000ea2f000000640000d1170000f86e00002c300000533400008f7400002d5d00004f3c00009e3500003c1100003907000067420000eb3c00004a0e0000c2440000933e00001f57000011660000ed620000666f0000c3300000fd470000f01600009353000083050000b45a00009d1d0000217000005621000006100000e06b00009b6a0000504e0000ff600000d907000062260000d22d0000fc2300009d1a000036430000d8280000c1150000fb670000d7790000ac2500007a5d0000c02100003e290000c65300003e220000fa6f000068150000767d000012500000542400007f0b0000b56a0000c2660000952c0000e1180000286a0000436f0000117400005413000039540000e15f0000d81d00001e520000da370000e62b000060640000954e0000167a0000717e00005f480000944c0000581c0000ff710000686a0000f61f00000c450000ad5400004e3500008a100000521c000079280000e67c000014280000c1710000ab7f0000a52a0000dd3e0000575f0000ad010000af1300005d7e0000b0440000115d0000a67700003c350000527f0000674e0000cd7b0000d71e000026770000a516000023710000760d0000192d0000e30e0000ac3f00001b720000942e0000e20c0000053000004b700000ca280000764f0000437700006d30000072500000720e0000a543000011300000590d00008f490000673100002957000066630000dd1900002f2d0000cc4300000d080000797400005f51000008200000686e0000124f000024390000e41d0000274100001a730000943e0000952000003177000012340000523400002d190000143b00008715000077430000b06300007a200000dc130000335900002a4b000030610000fb1b00004c340000ca1f0000866b000017770000861e00007d1f0000907a00003901000007000000d5210000cd610000641f00000b0b000043640000db5a00009e060000e6270000, Metadata: 227c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000223c0000223c0000227c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000223c0000223c0000227c0000227c0000227c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000227c0000227c0000223c0000227c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000223c0000223c0000223c0000227c0000227c0000227c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000223c0000227c0000227c0000227c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000223c0000227c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000227c0000223c0000227c0000223c0000223c0000223c0000223c0000223c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000223c0000227c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000223c0000223c0000223c0000227c0000227c0000223c0000227c0000223c0000227c0000227c0000227c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000227c0000227c0000223c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000227c0000227c0000223c0000227c0000223c0000223c0000223c0000223c0000223c0000223c0000227c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000223c0000227c0000227c0000227c0000227c0000223c0000223c0000223c0000223c0000223c0000223c0000227c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000223c0000227c0000227c0000227c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000223c0000227c0000227c0000223c0000227c0000223c0000223c0000223c0000227c0000227c0000223c0000227c0000227c0000227c0000227c0000223c0000227c0000227c0000223c0000223c0000227c0000227c0000223c0000)
Decrypted: Hello PQC World!
Encryption and decryption successful with Lattice-based HMAC verification!
```
